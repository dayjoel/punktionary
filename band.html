<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <title>Band Details | PUNKtionary</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/css/punk-styles.css">
</head>
<body class="bg-black text-white font-sans">
  
  <!-- Include Navbar -->
  <div id="navbar-container"></div>

  <main class="pt-24 max-w-5xl mx-auto px-6 pb-24">
    
    <!-- Back Button and Actions -->
    <div class="mb-8 flex items-center justify-between">
      <a href="/bands.html" class="punk-link inline-flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Back to Bands
      </a>
      <button id="suggestEditBtn" class="punk-button-outline hidden">Suggest Edit</button>
    </div>

    <!-- Loading State -->
    <div id="loadingState" class="text-center py-24">
      <div class="inline-block w-16 h-16 border-4 border-pink-500 border-t-transparent rounded-full animate-spin"></div>
      <p class="text-gray-400 mt-4 text-lg">Loading band details...</p>
    </div>

    <!-- Error State -->
    <div id="errorState" class="hidden text-center py-24">
      <h2 class="text-3xl font-bold mb-4 text-pink-500">Band Not Found</h2>
      <p class="text-gray-400 mb-8">The band you're looking for doesn't exist or has been removed.</p>
      <a href="/bands.html" class="punk-button">Browse All Bands</a>
    </div>

    <!-- Band Details Container -->
    <div id="bandDetails" class="hidden">
      
      <!-- Header Section -->
      <div class="mb-12">
        <div class="flex items-start gap-8 mb-4">
          <!-- Band Logo -->
          <div id="bandLogoContainer" class="hidden flex-shrink-0">
            <img id="bandLogo" src="" alt="Band Logo" class="max-w-xs max-h-48 object-contain border-2 border-pink-500 shadow-lg shadow-pink-500/20" />
          </div>

          <!-- Band Name and Status -->
          <div class="flex-1">
            <h1 id="bandName" class="text-6xl font-bold mb-4"></h1>
            <div id="bandStatus" class="mb-4"></div>
          </div>
        </div>

        <div class="punk-divider"></div>
      </div>

      <!-- Main Content Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <!-- Left Column - Main Info -->
        <div class="lg:col-span-2 space-y-8">
          
          <!-- Basic Info Card -->
          <div class="punk-card p-6">
            <h2 class="text-3xl font-bold mb-6 uppercase tracking-wider" style="font-family: 'Bebas Neue', sans-serif;">
              Band Info
            </h2>
            
            <div class="space-y-4">
              <div id="genreSection" class="hidden">
                <h3 class="text-pink-500 font-bold uppercase tracking-wide text-sm mb-2">Genre</h3>
                <p id="bandGenre" class="text-xl text-gray-300"></p>
              </div>

              <div id="locationSection" class="hidden">
                <h3 class="text-pink-500 font-bold uppercase tracking-wide text-sm mb-2">Location</h3>
                <p id="bandLocation" class="text-xl text-gray-300"></p>
              </div>

              <div id="countrySection" class="hidden">
                <h3 class="text-pink-500 font-bold uppercase tracking-wide text-sm mb-2">Country</h3>
                <p id="bandCountry" class="text-xl text-gray-300"></p>
              </div>
            </div>
          </div>

          <!-- Albums Card -->
          <div id="albumsCard" class="punk-card p-6 hidden">
            <h2 class="text-3xl font-bold mb-6 uppercase tracking-wider" style="font-family: 'Bebas Neue', sans-serif;">
              Albums
            </h2>
            <div id="bandAlbums" class="text-gray-300 text-lg"></div>
          </div>

          <!-- Photo References -->
          <div id="photosCard" class="punk-card p-6 hidden">
            <h2 class="text-3xl font-bold mb-6 uppercase tracking-wider" style="font-family: 'Bebas Neue', sans-serif;">
              Photos
            </h2>
            <div id="bandPhotos" class="text-gray-300"></div>
          </div>
        </div>

        <!-- Right Column - Sidebar -->
        <div class="lg:col-span-1 space-y-6">
          
          <!-- Links Card -->
          <div id="linksCard" class="punk-card p-6 hidden">
            <h2 class="text-2xl font-bold mb-4 uppercase tracking-wider" style="font-family: 'Bebas Neue', sans-serif;">
              Links
            </h2>
            <div id="bandLinks" class="space-y-3"></div>
          </div>

          <!-- Metadata Card -->
          <div class="punk-card p-6">
            <h2 class="text-2xl font-bold mb-4 uppercase tracking-wider" style="font-family: 'Bebas Neue', sans-serif;">
              Info
            </h2>
            <div class="space-y-2 text-sm text-gray-400">
              <p><strong class="text-pink-500">Added:</strong> <span id="bandCreated"></span></p>
              <p><strong class="text-pink-500">Updated:</strong> <span id="bandUpdated"></span></p>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Edit Suggestion Modal -->
    <div id="editModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
      <div class="punk-card max-w-4xl w-full max-h-[90vh] overflow-y-auto">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-3xl font-bold uppercase tracking-wider" style="font-family: 'Bebas Neue', sans-serif;">
            Suggest Edit
          </h2>
          <button id="closeEditModal" class="text-pink-500 hover:text-pink-400 text-3xl leading-none">&times;</button>
        </div>

        <p class="text-gray-300 mb-6">Suggest changes to this band's information. Your suggestions will be reviewed before being applied.</p>

        <form id="editForm" class="space-y-4">
          <input type="hidden" id="editBandId" name="band_id" />

          <div>
            <label class="block text-sm font-bold mb-2 text-pink-500 uppercase tracking-wide">Band Name</label>
            <input type="text" id="editName" name="name" class="punk-input" />
          </div>

          <div>
            <label class="block text-sm font-bold mb-2 text-pink-500 uppercase tracking-wide">Genres (Select up to 3)</label>
            <div id="editGenreCheckboxes" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 max-h-64 overflow-y-auto p-4 bg-black/30 border border-pink-500/30 rounded">
              <!-- Genre checkboxes will be populated by JavaScript -->
            </div>
            <p class="text-xs text-gray-500 mt-2" id="editGenreCount">0 of 3 genres selected</p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-bold mb-2 text-pink-500 uppercase tracking-wide">City</label>
              <input type="text" id="editCity" name="city" class="punk-input" />
            </div>
            <div>
              <label class="block text-sm font-bold mb-2 text-pink-500 uppercase tracking-wide">State/Territory</label>
              <select id="editState" name="state" class="punk-input">
                <option value="">Select state/territory</option>
                <!-- States will be populated by JavaScript -->
              </select>
            </div>
          </div>

          <div>
            <label class="block text-sm font-bold mb-2 text-pink-500 uppercase tracking-wide">Logo</label>
            <div class="mb-3">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" name="edit_logo_source" value="url" class="accent-pink-500" checked />
                <span>Use URL</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" name="edit_logo_source" value="upload" class="accent-pink-500" />
                <span>Upload File</span>
              </label>
            </div>
            <div id="editLogoUrlSection">
              <input type="url" id="editLogoUrl" name="logo_url" class="punk-input" placeholder="https://example.com/logo.jpg" />
              <p class="text-xs text-gray-500 mt-1">Provide a URL to the band's logo image</p>
            </div>
            <div id="editLogoFileSection" class="hidden">
              <input type="file" id="editLogoFile" name="logo_file" accept="image/*" class="punk-input" />
              <p class="text-xs text-gray-500 mt-1">Upload a logo image (JPG, PNG, GIF, WebP - max 5MB)</p>
            </div>
          </div>

          <div>
            <label class="block text-sm font-bold mb-2 text-pink-500 uppercase tracking-wide">Albums (comma-separated)</label>
            <input type="text" id="editAlbums" name="albums" class="punk-input" placeholder="Album One, Album Two, Album Three" />
          </div>

          <div>
            <label class="block text-sm font-bold mb-2 text-pink-500 uppercase tracking-wide">Links</label>
            <div class="space-y-2">
              <input type="url" id="editLinkWebsite" name="link_website" class="punk-input" placeholder="Website URL" />
              <input type="url" id="editLinkBandcamp" name="link_bandcamp" class="punk-input" placeholder="Bandcamp URL" />
              <input type="url" id="editLinkInstagram" name="link_instagram" class="punk-input" placeholder="Instagram URL" />
              <input type="url" id="editLinkFacebook" name="link_facebook" class="punk-input" placeholder="Facebook URL" />
              <input type="url" id="editLinkX" name="link_x" class="punk-input" placeholder="X (Twitter) URL" />
            </div>
          </div>

          <div>
            <label class="block text-sm font-bold mb-2 text-pink-500 uppercase tracking-wide">Currently Active?</label>
            <div class="flex gap-6">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" id="editActiveYes" name="active" value="1" class="accent-pink-500" />
                <span>Yes</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" id="editActiveNo" name="active" value="0" class="accent-pink-500" />
                <span>No</span>
              </label>
            </div>
          </div>

          <div class="flex gap-4 pt-4">
            <button type="submit" class="punk-button flex-1">Submit Suggestion</button>
            <button type="button" id="cancelEdit" class="punk-button-outline flex-1">Cancel</button>
          </div>
        </form>

        <!-- Success/Error Messages -->
        <div id="editSuccess" class="hidden mt-4 p-4 bg-pink-500/20 border-2 border-pink-500 rounded">
          <p class="text-pink-500 font-bold">Your edit suggestion has been submitted for review!</p>
        </div>
        <div id="editError" class="hidden mt-4 p-4 bg-red-500/20 border-2 border-red-500 rounded">
          <p class="text-red-500 font-bold" id="editErrorText"></p>
        </div>
      </div>
    </div>

  </main>

  <!-- Footer -->
  <footer class="py-12 text-center text-gray-500 border-t-2 border-pink-500/50">
    <div class="max-w-6xl mx-auto px-6">
      <p class="mb-4">Â© 2025 PUNKtionary. All rights reserved.</p>
      <div class="flex justify-center gap-6 text-sm">
        <a href="/about.html" class="punk-link">About</a>
        <a href="/contact.html" class="punk-link">Contact</a>
        <a href="/submit-band.html" class="punk-link">Submit</a>
      </div>
    </div>
  </footer>

  <!-- Load Navbar -->
  <script>
    fetch('/navbar.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('navbar-container').innerHTML = data;
        if (typeof initNavbar === 'function') {
          initNavbar();
        }
      })
      .catch(error => console.error('Error loading navbar:', error));
  </script>

  <script src="/navbar.js"></script>
  
  <script>
    // Get band ID from URL
    const urlParams = new URLSearchParams(window.location.search);
    const bandId = urlParams.get('id');

    if (!bandId) {
      showError();
    } else {
      loadBandDetails(bandId);
    }

    async function loadBandDetails(id) {
      const loadingState = document.getElementById('loadingState');
      const errorState = document.getElementById('errorState');
      const bandDetails = document.getElementById('bandDetails');

      try {
        const response = await fetch(`get_band.php?id=${id}`);
        
        if (!response.ok) {
          throw new Error('Band not found');
        }

        const band = await response.json();
        
        // Hide loading, show details
        loadingState.classList.add('hidden');
        bandDetails.classList.remove('hidden');

        // Update page title
        document.title = `${band.name} | PUNKtionary`;

        // Store band data for edit modal
        currentBandData = band;

        // Populate band details
        displayBandDetails(band);

        // Show suggest edit button
        document.getElementById('suggestEditBtn').classList.remove('hidden');

      } catch (error) {
        console.error('Error loading band:', error);
        showError();
      }
    }

    function displayBandDetails(band) {
      // Logo
      if (band.logo) {
        document.getElementById('bandLogoContainer').classList.remove('hidden');
        document.getElementById('bandLogo').src = band.logo;
        document.getElementById('bandLogo').alt = `${band.name} Logo`;
      }

      // Name and status
      document.getElementById('bandName').textContent = band.name;

      const statusBadge = band.active ?
        '<span class="punk-badge text-lg px-4 py-2">Active</span>' :
        '<span class="inline-block bg-gray-700 text-gray-300 px-4 py-2 text-sm font-bold uppercase">Inactive</span>';
      document.getElementById('bandStatus').innerHTML = statusBadge;

      // Genre
      if (band.genre) {
        document.getElementById('genreSection').classList.remove('hidden');
        document.getElementById('bandGenre').textContent = band.genre;
      }

      // Location
      const locationParts = [band.city, band.state].filter(Boolean);
      if (locationParts.length > 0) {
        document.getElementById('locationSection').classList.remove('hidden');
        document.getElementById('bandLocation').textContent = locationParts.join(', ');
      }

      // Country
      if (band.country) {
        document.getElementById('countrySection').classList.remove('hidden');
        document.getElementById('bandCountry').textContent = band.country;
      }

      // Albums
      if (band.albums) {
        document.getElementById('albumsCard').classList.remove('hidden');
        try {
          const albums = JSON.parse(band.albums);
          if (Array.isArray(albums) && albums.length > 0) {
            const albumsList = albums.map(album => 
              `<li class="text-gray-300 border-l-3 border-pink-500 pl-4 py-2">${album}</li>`
            ).join('');
            document.getElementById('bandAlbums').innerHTML = `<ul class="space-y-2">${albumsList}</ul>`;
          } else {
            document.getElementById('bandAlbums').textContent = band.albums;
          }
        } catch (e) {
          // If not JSON, just display as text
          document.getElementById('bandAlbums').textContent = band.albums;
        }
      }

      // Photos
      if (band.photo_references) {
        document.getElementById('photosCard').classList.remove('hidden');
        try {
          const photos = JSON.parse(band.photo_references);
          if (Array.isArray(photos) && photos.length > 0) {
            const photosHtml = photos.map(photoUrl => 
              `<div class="mb-4">
                <img src="${photoUrl}" alt="${band.name}" class="w-full rounded border-2 border-pink-500 shadow-lg shadow-pink-500/20" loading="lazy" />
              </div>`
            ).join('');
            document.getElementById('bandPhotos').innerHTML = photosHtml;
          } else if (typeof photos === 'string') {
            // Single photo URL
            document.getElementById('bandPhotos').innerHTML = 
              `<img src="${photos}" alt="${band.name}" class="w-full rounded border-2 border-pink-500 shadow-lg shadow-pink-500/20" loading="lazy" />`;
          } else {
            document.getElementById('bandPhotos').innerHTML = `<p class="text-gray-400">${band.photo_references}</p>`;
          }
        } catch (e) {
          // If not JSON, check if it's a single URL
          if (band.photo_references.startsWith('http')) {
            document.getElementById('bandPhotos').innerHTML = 
              `<img src="${band.photo_references}" alt="${band.name}" class="w-full rounded border-2 border-pink-500 shadow-lg shadow-pink-500/20" loading="lazy" />`;
          } else {
            document.getElementById('bandPhotos').innerHTML = `<p class="text-gray-400">${band.photo_references}</p>`;
          }
        }
      }

      // Links
      if (band.links) {
        try {
          const links = JSON.parse(band.links);
          const linksHtml = Object.entries(links).map(([platform, url]) => 
            `<a href="${url}" target="_blank" rel="noopener noreferrer" class="punk-button-outline block text-center">
              ${platform}
            </a>`
          ).join('');
          
          if (linksHtml) {
            document.getElementById('linksCard').classList.remove('hidden');
            document.getElementById('bandLinks').innerHTML = linksHtml;
          }
        } catch (e) {
          // If not JSON, treat as single link
          if (band.links.trim()) {
            document.getElementById('linksCard').classList.remove('hidden');
            document.getElementById('bandLinks').innerHTML = 
              `<a href="${band.links}" target="_blank" rel="noopener noreferrer" class="punk-button-outline block text-center">
                Website
              </a>`;
          }
        }
      }

      // Dates
      if (band.created_at) {
        const createdDate = new Date(band.created_at);
        document.getElementById('bandCreated').textContent = createdDate.toLocaleDateString();
      }
      if (band.updated_at) {
        const updatedDate = new Date(band.updated_at);
        document.getElementById('bandUpdated').textContent = updatedDate.toLocaleDateString();
      }
    }

    function showError() {
      document.getElementById('loadingState').classList.add('hidden');
      document.getElementById('errorState').classList.remove('hidden');
    }

    // Edit Modal Functionality
    let currentBandData = null;
    const genres = ['Afro-punk', 'Anarcho punk', 'Art punk', 'Celtic punk', 'Christian punk', 'Cowpunk', 'Crust punk', 'Dance-punk', 'Dark cabaret', 'Folk punk', 'Garage punk', 'Glam punk', 'Grindcore', 'Gypsy punk', 'Hardcore punk', 'Horror punk', 'Latin punk', 'Melodic punk', 'Oi!', 'Peace punk', 'Pop-punk', 'Psychobilly', 'Punk blues', 'Punk jazz', 'Punk metal', 'Queercore', 'Riot Grrrl', 'Ska punk and ska-core', 'Skate punk', 'Street punk', 'Synthpunk'];

    const states = ['AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'FL', 'GA', 'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD', 'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ', 'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY', 'DC', 'AS', 'GU', 'MP', 'PR', 'VI'];

    // Toggle logo source sections
    document.querySelectorAll('input[name="edit_logo_source"]').forEach(radio => {
      radio.addEventListener('change', function() {
        if (this.value === 'url') {
          document.getElementById('editLogoUrlSection').classList.remove('hidden');
          document.getElementById('editLogoFileSection').classList.add('hidden');
        } else {
          document.getElementById('editLogoUrlSection').classList.add('hidden');
          document.getElementById('editLogoFileSection').classList.remove('hidden');
        }
      });
    });

    document.getElementById('suggestEditBtn').addEventListener('click', function() {
      if (!currentBandData) return;

      // Populate genre checkboxes
      const genreContainer = document.getElementById('editGenreCheckboxes');
      genreContainer.innerHTML = genres.map(genre => `
        <label class="flex items-center gap-2 cursor-pointer hover:text-pink-500 transition-colors">
          <input type="checkbox" name="edit_genres" value="${genre}" class="edit-genre-checkbox accent-pink-500" />
          <span class="text-sm">${genre}</span>
        </label>
      `).join('');

      // Populate state dropdown
      const stateSelect = document.getElementById('editState');
      stateSelect.innerHTML = '<option value="">Select state/territory</option>' +
        states.map(state => `<option value="${state}">${state}</option>`).join('');

      // Set up genre checkbox limit
      setupEditGenreLimit();

      // Populate form with current data
      populateEditForm(currentBandData);

      // Show modal
      document.getElementById('editModal').classList.remove('hidden');
    });

    document.getElementById('closeEditModal').addEventListener('click', closeEditModal);
    document.getElementById('cancelEdit').addEventListener('click', closeEditModal);

    function closeEditModal() {
      document.getElementById('editModal').classList.add('hidden');
      document.getElementById('editSuccess').classList.add('hidden');
      document.getElementById('editError').classList.add('hidden');
    }

    function setupEditGenreLimit() {
      const checkboxes = document.querySelectorAll('.edit-genre-checkbox');
      const counter = document.getElementById('editGenreCount');

      checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const checked = document.querySelectorAll('.edit-genre-checkbox:checked');
          counter.textContent = `${checked.length} of 3 genres selected`;

          if (checked.length >= 3) {
            checkboxes.forEach(box => {
              if (!box.checked) {
                box.disabled = true;
                box.parentElement.classList.add('opacity-50', 'cursor-not-allowed');
              }
            });
          } else {
            checkboxes.forEach(box => {
              box.disabled = false;
              box.parentElement.classList.remove('opacity-50', 'cursor-not-allowed');
            });
          }
        });
      });
    }

    function populateEditForm(band) {
      document.getElementById('editBandId').value = band.id;
      document.getElementById('editName').value = band.name || '';
      document.getElementById('editCity').value = band.city || '';
      document.getElementById('editState').value = band.state || '';
      document.getElementById('editLogoUrl').value = band.logo || '';

      // Set genres
      if (band.genre) {
        const bandGenres = band.genre.split(',').map(g => g.trim());
        document.querySelectorAll('.edit-genre-checkbox').forEach(cb => {
          cb.checked = bandGenres.includes(cb.value);
        });
        document.getElementById('editGenreCount').textContent = `${bandGenres.length} of 3 genres selected`;
      }

      // Set albums
      if (band.albums) {
        try {
          const albums = JSON.parse(band.albums);
          document.getElementById('editAlbums').value = Array.isArray(albums) ? albums.join(', ') : band.albums;
        } catch(e) {
          document.getElementById('editAlbums').value = band.albums || '';
        }
      }

      // Set links
      if (band.links) {
        try {
          const links = JSON.parse(band.links);
          document.getElementById('editLinkWebsite').value = links.Website || '';
          document.getElementById('editLinkBandcamp').value = links.Bandcamp || '';
          document.getElementById('editLinkInstagram').value = links.Instagram || '';
          document.getElementById('editLinkFacebook').value = links.Facebook || '';
          document.getElementById('editLinkX').value = links.X || '';
        } catch(e) {}
      }

      // Set active status
      if (band.active == 1) {
        document.getElementById('editActiveYes').checked = true;
      } else {
        document.getElementById('editActiveNo').checked = true;
      }
    }

    document.getElementById('editForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      // Hide previous messages
      document.getElementById('editSuccess').classList.add('hidden');
      document.getElementById('editError').classList.add('hidden');

      // Collect form data
      const formData = new FormData(this);

      // Process genres
      const selectedGenres = Array.from(document.querySelectorAll('.edit-genre-checkbox:checked')).map(cb => cb.value);
      formData.delete('edit_genres');
      if (selectedGenres.length > 0) {
        formData.set('genre', selectedGenres.join(', '));
      }

      // Process logo - determine source and set appropriate field
      const logoSource = formData.get('edit_logo_source');
      formData.set('logo_source', logoSource);
      formData.delete('edit_logo_source');

      // Process links
      const links = {};
      ['website', 'bandcamp', 'instagram', 'facebook', 'x'].forEach(platform => {
        const value = formData.get(`link_${platform}`);
        if (value && value.trim()) {
          const platformName = platform === 'x' ? 'X' : platform.charAt(0).toUpperCase() + platform.slice(1);
          links[platformName] = value.trim();
        }
        formData.delete(`link_${platform}`);
      });
      if (Object.keys(links).length > 0) {
        formData.set('links', JSON.stringify(links));
      }

      try {
        const response = await fetch('/api/submit_edit.php', {
          method: 'POST',
          body: formData
        });

        const data = await response.json();

        if (response.ok && data.success) {
          document.getElementById('editSuccess').classList.remove('hidden');
          setTimeout(() => {
            closeEditModal();
          }, 2000);
        } else {
          document.getElementById('editErrorText').textContent = data.error || 'Failed to submit edit suggestion';
          document.getElementById('editError').classList.remove('hidden');
        }
      } catch (error) {
        console.error('Edit submission error:', error);
        document.getElementById('editErrorText').textContent = 'Network error. Please try again.';
        document.getElementById('editError').classList.remove('hidden');
      }
    });
  </script>
</body>
</html>